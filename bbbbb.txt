import org.apache.flink.util.Collector;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
import static org.mockito.Mockito.never;
import static org.mockito.Mockito.verify;

class TexttoJsonTransformerTest {

    // flatMap_Success test remains the same as before

    @Test
    void flatMap_Failure() throws Exception {
        // Creating a test input string with incorrect format
        String testInput = "value1,value2"; // Less elements than expected

        // Mocking the Collector
        Collector<String> collector = Mockito.mock(Collector.class);

        // Creating an instance of the TexttoJsonTransformer
        TexttoJsonTransformer transformer = new TexttoJsonTransformer();

        // Invoking the flatMap method with the test input
        transformer.flatMap(testInput, collector);

        // Verifying that the collector was never interacted with
        verify(collector, never()).collect(Mockito.any());
    }
}
