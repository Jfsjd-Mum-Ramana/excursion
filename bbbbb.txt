import org.apache.flink.util.Collector;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertThrows;

class TexttoJsonTransformerTest {

    // flatMap_Success test remains the same as before

    @Test
    void flatMap_EmptyInput_Failure() {
        // Creating an empty test input string
        String testInput = "";

        // Creating an instance of the TexttoJsonTransformer
        TexttoJsonTransformer transformer = new TexttoJsonTransformer();

        // Invoking the flatMap method with the empty test input and asserting the exception
        assertThrows(Exception.class, () -> transformer.flatMap(testInput, new Collector<String>() {
            @Override
            public void collect(String s) { }

            @Override
            public void close() { }
        }));
    }
}
