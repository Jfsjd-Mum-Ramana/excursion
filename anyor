CREATE OR REPLACE FUNCTION delete_old_records()
RETURNS VOID AS
$$
BEGIN
    -- Delete old records from hpov_s2im_devices_audit (older than 7 days)
    DELETE FROM hpov_s2im_devices_audit 
    WHERE update_timestamp < NOW() - INTERVAL '7 days';

    -- Delete old records from hpov_s2im_transactions (older than 7 days)
    DELETE FROM hpov_s2im_transactions
    WHERE collected_time < NOW() - INTERVAL '7 days';

    RAISE NOTICE 'Old records deleted successfully at %', NOW();
END;
$$
LANGUAGE plpgsql;