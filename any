import com.amazonaws.auth.AWSStaticCredentialsProvider;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.client.builder.AwsClientBuilder;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3ClientBuilder;
import com.amazonaws.services.s3.model.ListObjectsV2Request;
import com.amazonaws.services.s3.model.ListObjectsV2Result;
import com.amazonaws.services.s3.model.S3ObjectSummary;

import java.util.List;

public class S3ListObjectsExample {

    public static void main(String[] args) {
        String accessKey = "your_access_key";
        String secretKey = "your_secret_key";
        String region = "eu-north-1";
        String bucketName = "your_bucket_name";

        BasicAWSCredentials credentials = new BasicAWSCredentials(accessKey, secretKey);
        AWSStaticCredentialsProvider credentialsProvider = new AWSStaticCredentialsProvider(credentials);

        AmazonS3 s3Client = AmazonS3ClientBuilder.standard()
                .withCredentials(credentialsProvider)
                .withRegion(region)
                .build();

        // Create a request to list objects in the bucket
        ListObjectsV2Request listObjectsRequest = new ListObjectsV2Request().withBucketName(bucketName);

        // Call the listObjectsV2 method to get the object listing
        ListObjectsV2Result result = s3Client.listObjectsV2(listObjectsRequest);

        // Get the list of object summaries from the result
        List<S3ObjectSummary> objectSummaries = result.getObjectSummaries();

        // Print the object keys
        System.out.println("Objects in bucket " + bucketName + ":");
        for (S3ObjectSummary objectSummary : objectSummaries) {
            System.out.println("Object Key: " + objectSummary.getKey());
        }
    }
}
