import com.amazonaws.auth.AWSStaticCredentialsProvider;
import com.amazonaws.auth.BasicAWSCredentials;
import com.amazonaws.client.builder.AwsClientBuilder.EndpointConfiguration;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3ClientBuilder;
import com.amazonaws.services.s3.model.ListObjectsV2Request;
import com.amazonaws.services.s3.model.ListObjectsV2Result;
import com.amazonaws.services.s3.model.S3ObjectSummary;

import java.util.List;

public class S3ListObjectsExample {

    public static void main(String[] args) {
        String accessKey = "your_access_key";
        String secretKey = "your_secret_key";
        String region = "your_region";
        String bucketName = "your_bucket_name";

        BasicAWSCredentials credentials = new BasicAWSCredentials(accessKey, secretKey);
        AWSStaticCredentialsProvider credentialsProvider = new AWSStaticCredentialsProvider(credentials);

        AmazonS3 s3Client = AmazonS3ClientBuilder.standard()
                .withCredentials(credentialsProvider)
                .withEndpointConfiguration(new EndpointConfiguration("https://s3." + region + ".amazonaws.com", region))
                .build();

        // Create a request to list objects in the bucket
        ListObjectsV2Request listObjectsRequest = new ListObjectsV2Request().withBucketName(bucketName);

        // Call the listObjectsV2 method to get the object listing
        ListObjectsV2Result result = s3Client.listObjectsV2(listObjectsRequest);

        // Get the list of object summaries from the result
        List<S3ObjectSummary> objectSummaries = result.getObjectSummaries();

        // Process the object summaries
        for (S3ObjectSummary objectSummary : objectSummaries) {
            // Print or process each object summary
            System.out.println("Object Key: " + objectSummary.getKey());
        }
    }
}
