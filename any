@Test
    public void testRetrieveAttributesWhenFileTypeIsZipThenSuccess() throws Exception {
        SpaceCollector spaceCollector = new SpaceCollector();
        spaceCollector.setUrl("localhost");
        spaceCollector.setPort(22);
        spaceCollector.setUserName("username");
        spaceCollector.setPassword("password");
        spaceCollector.setInputFilePath("/path/to/input");
        spaceCollector.setOutputFilePath("/path/to/output");

        // Mock the findLatestByFilePaths() method to return two records
        List<CollectionAudit> audits = new ArrayList<>();
        for (String fileName : new String[]{"/path/to/input/Sample1.tar.gz"}) {
            CollectionAudit audit = mock(CollectionAudit.class);
            when(audit.getInputFilePath()).thenReturn(fileName);
            when(audit.getJobStatus()).thenReturn(fileName.equals("/path/to/input/Sample1.tar.gz") ? "COLLECTION_FAILED" : "COLLECTION_SUCCESS");
            audits.add(audit);
        }
        doReturn(audits).when(collectionAuditRepository).findLatestByFilePaths(anyList());

        // Mock the ls() method to return three files
        Vector<ChannelSftp.LsEntry> files = new Vector<>();
        for (String fileName : new String[]{"Sample1.tar.gz"}) {
            ChannelSftp.LsEntry file = mock(ChannelSftp.LsEntry.class);
            SftpATTRS attrs = mock(SftpATTRS.class);
            when(file.getFilename()).thenReturn(fileName);
            when(file.getAttrs()).thenReturn(attrs);
            when(attrs.isDir()).thenReturn(false);
            files.add(file);
        }
        when(channelSftp.ls(anyString())).thenReturn(files);

        // Mock the outputStreamCreator.create method
        OutputStream mockOutputStream = mock(OutputStream.class);
        when(outputStreamCreator.create(anyString())).thenReturn(mockOutputStream);

        // Mock the channelSftp.get method
        InputStream mockInputStream = mock(InputStream.class);
        when(channelSftp.get(anyString())).thenReturn(mockInputStream);

        // Mock the behavior of the InputStream and OutputStream
        when(mockInputStream.read(ArgumentMatchers.any(byte[].class))).thenReturn(-1); // Simulate end of stream
        doNothing().when(mockOutputStream).close();
        doNothing().when(mockInputStream).close();


        boolean result = sshService.retrieveData(spaceCollector, collectorUtil.getDateAsString(new Date()), "3459-DEV-COLLECTION-AUDIT-QUEUE");

        // Verify that get() method is called twice
        verify(channelSftp, times(3)).get(anyString());
    }



@Test
    public void testRetrieveData_Success() throws Exception {
        when(kafkaProducerService.writeMessage(Mockito.any(), anyString(), anyString())).thenReturn(true);

        InputStream mockInputStream = mock(InputStream.class);
        when(channelSftp.get(anyString())).thenReturn(mockInputStream);

        OutputStream mockOutputStream = mock(OutputStream.class);
        when(outputStreamCreator.create(anyString())).thenReturn(mockOutputStream);

        when(mockInputStream.read(ArgumentMatchers.any(byte[].class))).thenReturn(-1); // Simulate end of stream
        doNothing().when(mockOutputStream).close();
        doNothing().when(mockInputStream).close();

        Vector<ChannelSftp.LsEntry> files = new Vector<>();
        for (String fileName : new String[]{"Sample1.csv", "Sample2.csv", "Sample3.csv"}) {
            ChannelSftp.LsEntry file = mock(ChannelSftp.LsEntry.class);
            SftpATTRS attrs = mock(SftpATTRS.class);
            when(file.getFilename()).thenReturn(fileName);
            when(file.getAttrs()).thenReturn(attrs);
            when(attrs.isDir()).thenReturn(false);
            files.add(file);
        }
        when(channelSftp.ls(anyString())).thenReturn(files);

        List<CollectionAudit> audits = new ArrayList<>();
        for (String fileName : new String[]{"/path/to/input/Sample1.csv", "/path/to/input/Sample3.csv"}) {
            CollectionAudit audit = mock(CollectionAudit.class);
            when(audit.getInputFilePath()).thenReturn(fileName);
            when(audit.getJobStatus()).thenReturn(fileName.equals("/path/to/input/Sample1.csv") ? "COLLECTION_FAILED" : "COLLECTION_SUCCESS");
            audits.add(audit);
        }
        doReturn(audits).when(collectionAuditRepository).findLatestByFilePaths(anyList());

        SpaceCollector spaceCollector = new SpaceCollector();
        spaceCollector.setUrl("localhost");
        spaceCollector.setPort(22);
        spaceCollector.setUserName("username");
        spaceCollector.setPassword("password");
        spaceCollector.setInputFilePath("/path/to/input");
        spaceCollector.setOutputFilePath("/path/to/output");

        when(collectorUtil.getDateAsString(Mockito.any())).thenReturn("2021-01-01");

        boolean result = sshService.retrieveData(spaceCollector, collectorUtil.getDateAsString(new Date()), "3459-DEV-COLLECTION-AUDIT-QUEUE");

        verify(channelSftp, times(3)).get(anyString());
    }

    @Test
    public void testRetrieveData_FileRetrievalFailureForSpecificFile() throws Exception {
        InputStream mockInputStream = mock(InputStream.class);
        when(channelSftp.get(anyString())).thenReturn(mockInputStream);
        when(channelSftp.get("/path/to/input/Sample2.csv")).thenThrow(new SftpException(0, "file retrieval failed"));

        OutputStream mockOutputStream = mock(OutputStream.class);
        when(outputStreamCreator.create(anyString())).thenReturn(mockOutputStream);

        when(mockInputStream.read(ArgumentMatchers.any(byte[].class))).thenReturn(-1); // Simulate end of stream
        doNothing().when(mockOutputStream).close();
        doNothing().when(mockInputStream).close();

        Vector<ChannelSftp.LsEntry> files = new Vector<>();
        for (String fileName : new String[]{"Sample1.csv", "Sample2.csv", "Sample3.csv"}) {
            ChannelSftp.LsEntry file = mock(ChannelSftp.LsEntry.class);
            SftpATTRS attrs = mock(SftpATTRS.class);
            when(file.getFilename()).thenReturn(fileName);
            when(file.getAttrs()).thenReturn(attrs);
            when(attrs.isDir()).thenReturn(false);
            files.add(file);
        }
        when(channelSftp.ls(anyString())).thenReturn(files);

        List<CollectionAudit> audits = new ArrayList<>();
        for (String fileName : new String[]{"/path/to/input/Sample1.csv", "/path/to/input/Sample3.csv"}) {
            CollectionAudit audit = mock(CollectionAudit.class);
            when(audit.getInputFilePath()).thenReturn(fileName);
            when(audit.getJobStatus()).thenReturn(fileName.equals("/path/to/input/Sample1.csv") ? "COLLECTION_FAILED" : "COLLECTION_SUCCESS");
            audits.add(audit);
        }
        doReturn(audits).when(collectionAuditRepository).findLatestByFilePaths(anyList());

        SpaceCollector spaceCollector = new SpaceCollector();
        spaceCollector.setUrl("localhost");
        spaceCollector.setPort(22);
        spaceCollector.setUserName("username");
        spaceCollector.setPassword("password");
        spaceCollector.setInputFilePath("/path/to/input");
        spaceCollector.setOutputFilePath("/path/to/output");

        boolean result = sshService.retrieveData(spaceCollector, collectorUtil.getDateAsString(new Date()), "3459-DEV-COLLECTION-AUDIT-QUEUE");

        verify(channelSftp, times(3)).get(anyString());
    }


This test cases are failing plss resolve 

Wanted but not invoked:
channelSftp.get(<any string>);
-> at com.jcraft.jsch.ChannelSftp.get(ChannelSftp.java:1290)

However, there were exactly 3 interactions with this mock:
channelSftp.connect();
-> at org.vdsi.space.collections.customsshcollector.services.SSHService.getChannelSftp(SSHService.java:270)

channelSftp.ls("/path/to/input/");
-> at org.vdsi.space.collections.customsshcollector.services.SSHService.retrieveAndProcessDirectory(SSHService.java:88)

channelSftp.disconnect();
-> at org.vdsi.space.collections.customsshcollector.services.SSHService.retrieveData(SSHService.java:77)


Wanted but not invoked:
channelSftp.get(<any string>);
-> at com.jcraft.jsch.ChannelSftp.get(ChannelSftp.java:1290)

However, there were exactly 3 interactions with this mock:
channelSftp.connect();
-> at org.vdsi.space.collections.customsshcollector.services.SSHService.getChannelSftp(SSHService.java:270)

channelSftp.ls("/path/to/input/");
-> at org.vdsi.space.collections.customsshcollector.services.SSHService.retrieveAndProcessDirectory(SSHService.java:88)

channelSftp.disconnect();
-> at org.vdsi.space.collections.customsshcollector.services.SSHService.retrieveData(SSHService.java:77)


	at com.jcraft.jsch.ChannelSftp.get(ChannelSftp.java:1290)
	at org.vdsi.space.collections.customsshcollector.junits.services.SSHServiceTest.testRetrieveData_Success(SSHServiceTest.java:172)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)

Try to resolve
